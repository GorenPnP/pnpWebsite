version: '3'

services:
        web:
                container_name: pnp-web
                build: ./ppServer
                command: python manage.py runserver 0.0.0.0:8000
                volumes:
                        - static_volume:/home/ppServer/web/static
                        - media_volume:/home/ppServer/web/media
                expose:
                        - 8000
                env_file:
                        - ./.env.dev
                depends_on:
                        - db

        db:
                container_name: pnp-db
                image: postgres:12.0-alpine
                volumes:
                        - postgres_data:/var/lib/postgresql/data
                expose:
                        - 5432
                env_file:
                        - ./.env.dev.db
        
        nginx:
                container_name: pnp-nginx
                build: ./nginx
                volumes:
                        - static_volume:/home/ppServer/web/static
                        - media_volume:/home/ppServer/web/media
                ports:
                        - 80:80
                expose:
                        - 80
                depends_on:
                        - web
            
volumes:
        postgres_data:
        static_volume:
        media_volume:
