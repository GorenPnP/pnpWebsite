{% extends 'base/headed_main.html' %}
{% load static resources %}

{% block extra-head %}{{ block.super }}
<style>
    table {
        max-width: 800px;
        margin-inline: auto;
    }

    .zauber-input {
        height: 30px;
        aspect-ratio: 1;
    }

    .card {
        width: fit-content;
        min-width: min(100%, 300px);
    }
    .tier {
        width: 18px;
        aspect-ratio: 1;
        border: 1px solid white;
        margin: 2px;
    }
    .tier-filled { background-color: var(--bs-success); }
    .tier-blocked { background-color: #ccc; }
    .scroll-y {
        max-height: 150px;
        overflow-y: auto;
    }
</style>

<script type="text/javascript" src="{% static 'create/js/zauber.js' %}"></script>
{% endblock %}

{% block asides %}
{% resources %}
    <!-- Resources -->
    <a class="text-light mb-3 d-block" href="{% url 'shop:zauber' %}" target="_blank">alle Zauber</a>

    <div class="fw-bold">Zauberslots</div>
    <ul aria-label="Zauberslots">
        {% for stufe, amount in char.zauberplätze.items %}
        <li><b>{{amount}} Stufe {{stufe}}</b> Zauber</li>
        {% endfor %}
    </ul>

    <div class="fw-bold">was Anderes</div>
    <ul aria-label="was Anderes">
        <li>{{char.sp}} SP</li>
        <li>{{char.ap}} AP / {{MA_aktuell}} MA</li>
        <li>{{char.geld}} Drachmen</li>
    </ul>

    <div class="mt-3">
        <label for="payment-method" class="fw-bold mb-1">Bezahle Tier mit</label>
        <select id="payment-method" class="form-select">
            <option value="slot">Zauberslots</option>
            <option value="sp">SP</option>
            <option value="ap">AP / MA-Attribut</option>
        </select>
    </div>
{% endresources %}
{% endblock %}

{% block main %}

    <h2>Deine bisherigen Zauber</h2>
    {% for rel in existing_zauber %}
        {% include 'create/_zauber_card.html' with rel=rel max_tier_allowed=max_tier_allowed %}
    {% endfor %}

    <h2>Deine neuen Zauber</h2>
    {% for rel in new_zauber %}
        {% include 'create/_zauber_card.html' with rel=rel max_tier_allowed=max_tier_allowed %}
    {% endfor %}


    {% if free_slots > 0 %}
    <div class="btn-group">
        <button type="button" class="btn btn-lg btn-primary">Neuen Zauber lernen</button>
        <button type="button" class="btn btn-lg btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
        <span class="visually-hidden">Toggle Dropdown</span>
        </button>
        <ul class="dropdown-menu">
            <li><button class="dropdown-item active" type="button">---</a></li>
            {% for z in zauber %}
            <li><button class="dropdown-item" type="button" value="{{ z.id }}">{{ z.name }}</button></li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

        
    <form id="form" method="post" class="d-flex justify-content-center">
        {% csrf_token %}
        <button type="submit" class="btn btn-lg btn-primary m-2" disabled>Speichern</button>
        <a class="btn btn-lg btn-outline-primary m-2" href="{{ back_url }}">Zurück</a>
    </form>
{% endblock %}
